<script>
    (() => {
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(async position => {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                const accuracy = position.coords.accuracy;
                const userCoordinate = `${ longitude },${ latitude }`;

                const response = await fetch(`/route/${ userCoordinate }`, { method: 'POST' });
                // const response = await fetch(`/route/${ userCoordinate }`, { method: 'post', headers: { 'content-type': 'application/json' } });
                if (!response.ok) { throw new Error(`Network response was not ok ${ response.statusText }`) }
            }, error => {
                console.log(error)
            }, {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            });
        } else {
            alert('Geolocation is not supported by this browser.');
        }
    })();
</script>